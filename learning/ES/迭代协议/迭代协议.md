## 迭代协议

### Iterator

参考：https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Iterators_and_generators

> Async Iterator 参考下方 async

迭代协议分为可迭代协议和迭代器协议即 Generator，后者是基于前者拓宽，具体参考下方

可迭代协议中的迭代方式有如下六种，但只建议使用前四种即可：

1. for

推荐写法:

```js
for (var i = 0, max = myarray.length; i < max; i++) {
  // 使用myarray[i]做点什么
}
```

2. for...in
3. for...of
4. for await...of：用于并发，具体参考下方 async
5. do...while
6. while
7. for each...in

### for-in & forEach

[[enumerable]]

### for-of

### Generator

- 本质即一个返回遍历器对象 Iterator Object 的函数
- 流程：
  1. 执行 Generator Function 返回一个并不执行，但指向内部状态的指针对象即 Iterator Object
  2. 调用(Iterator Object).next()会使得整个函数执行完下一个 yield 关键字之前的所有代码，并将`yield xxx`后的 xxx 作为(Iterator Object).value
  3. 重复 2 中步骤将改变(Iterator Object).value，直至执行到`return aaa`，此时`(Iterator Object).value === aaa`且`(Iterator Object).done === true`
  4. 执行完 return 后再(Iterator Object).next()将使得`(Iterator Object).value = undefined`
- Iterator 具有 next()，throw()，return()三种方法
- 如 async-await 即是基于 Promise 和 Generator 的语法糖
- 相当于一个封装了多种状态的状态机，每个 yield 代表一种状态，一共有 yield + 1 种状态
